\documentclass[11pt, a4paper]{book}
\usepackage[svgnames,table,dvipsnames]{xcolor} % For color names
\usepackage{fontspec} % font selecting commands
\usepackage{tcolorbox} % For colored boxes
\usepackage{graphicx} % For pictures
\usepackage[export]{adjustbox}
\usepackage{polyglossia} % Babel alternative in XeLaTex
\usepackage{fancyhdr} % For page headers
\usepackage[top=2.5cm, bottom=2.5cm, left=3cm, right=2cm]{geometry} % To control page margins
\usepackage{listings} % For source code
\usepackage[colorlinks=true,
            urlcolor=RedOrange,
            unicode=true,
            pdftitle={تعلّم البرمجة بلغة الـC},
            pdfauthor={عدن بلواضح,حمزة عباد,أحمد زبوشي}
            pdfdisplaydoctitle=true]{hyperref} % For hyperlinks and PDF metadata
\usepackage{float}
\usepackage{tabu,booktabs}
\usepackage{bidi}
% Language settings
\setmainlanguage[locale=algeria]{arabic}
\setotherlanguage{english}
\addto\captionsarabic{ % Without this, changes won't take effect, because of Polyglossia
  \renewcommand{\partname}{الجزء}
  \renewcommand{\chaptername}{الفصل}
}
% Font settings
\defaultfontfeatures{Ligatures=TeX}
\newfontfamily\arabicfont[Script=Arabic, Scale=1.2]{Amiri} % An arabic font
\newfontfamily\englishfont[Script=Latin]{Liberation Sans} % Font used for latin text in the document
\newfontfamily\arabicfonttt{Liberation Mono} % Monospace font, for displaying codes
% Boxes definitions
\tcbset{boxrule=0mm, arc=2pt}
\newtcolorbox{question}{colback=blue!70!green!10, colframe=blue!80!green!5, fontupper=\itshape} % Used for question boxes
\newtcolorbox{critical}{colback=red!20, colframe=red!50} % Used for critical warning boxes
\newtcolorbox{warning}{colback=yellow!20, colframe=yellow!50} % Used for warning boxes
\newtcolorbox{information}{colback=blue!5!green!20, colframe=blue!10!green} % Used for information boxes
\newcommand\InlineCode[1]{\fcolorbox{LightGray}{Snow}{\ttfamily \LR{#1}}}
% Titles settings (Make them orange)
\makeatletter
\let\oldchapter\chapter
\newcommand{\@chapterstar}[1]{\cleardoublepage\phantomsection\addcontentsline{toc}{chapter}{#1}{\color{green!30!blue!80}\oldchapter*{#1}}}
\newcommand{\@chapternostar}[1]{{\color{green!30!blue!80}\oldchapter{#1}}}
\renewcommand{\chapter}{\@ifstar{\@chapterstar}{\@chapternostar}}
\let\oldpart\part
\newcommand{\@partstar}[1]{\cleardoublepage\phantomsection\addcontentsline{toc}{part}{#1}{\color{orange}\oldpart*{#1}}}
\newcommand{\@partnostar}[1]{{\color{orange}\oldpart{#1}}}
\renewcommand{\part}{\setcounter{chapter}{0}\@ifstar{\@partstar}{\@partnostar}}
\let\oldsection\section
\newcommand{\@sectionstar}[1]{\phantomsection\addcontentsline{toc}{section}{#1}{\color{orange}\oldsection*{#1}}\sectionmark{#1}}
\newcommand{\@sectionnostar}[1]{{\color{orange}\oldsection{#1}}}
\renewcommand\section{\@ifstar{\@sectionstar}{\@sectionnostar}}
\makeatother
% Pictures settings
\graphicspath{{Pictures/}} % Folder of pictures
\newcommand\Picture[2][]{ % This command automatically centers the picture and fits its size to the page. It supports captions too.
  \begin{center}
    \includegraphics[max size={0.8\textwidth}{0.5\textheight}]{#2}\\
    #1
  \end{center}
}
% Paragraphs settings
\setlength{\parskip}{4mm plus 2mm minus 2mm} % Spacing between paragraphs (+/-)
% Page header and footer settings
\setlength{\headheight}{15pt}
\pagestyle{fancy}
\renewcommand{\chaptermark}[1]{ \markboth{{\chaptername~\thechapter.~#1}}{} }
\renewcommand{\sectionmark}[1]{ \markright{#1} }
\fancyhead{}
\fancyhead[OR]{\rightmark}
\fancyhead[EL]{\leftmark}
\setlength{\footskip}{1.5cm}
% Fixing the issues of the numbering
\renewcommand{\thepart}{\Alph{part}}
\renewcommand{\thechapter}{\Alph{part}.\arabic{chapter}}
\renewcommand{\thesection}{\Alph{part}.\arabic{section}.\arabic{chapter}}
\renewcommand{\thesubsection}{\Alph{part}.\arabic{subsection}.\arabic{section}.\arabic{chapter}}
\renewcommand{\thesubsubsection}{\Alph{part}.\arabic{subsubsection}.\arabic{subsection}.\arabic{section}.\arabic{chapter}}
\setcounter{secnumdepth}{1}
% Global settings for code and console
\lstset{frame=single, basicstyle=\ttfamily, breaklines=true, showlines, aboveskip=\parskip}
% C source code
\lstdefinestyle{C}{language=C, showstringspaces=false, numbers=left,
        keywordstyle=\bfseries\color{RoyalBlue}, commentstyle=\itshape\color{Gray},
        numberstyle=\color{Gray}, stringstyle=\color{Crimson},
        directivestyle=\color{DarkOrange},
        deletekeywords={return,if,else,switch,for,while,do,const,static,sizeof},
    	morekeywords={SDL_Surface,Uint32,SDL_Rect,SDL_Event,SDL_TimerID,SDL_NewTimerCallback,TTF_Font,SDL_Color,
    	FMOD_SYSTEM,FMOD_RESULT,FMOD_SOUND,FMOD_CHANNEL,FMOD_CHANNELGROUP,FMOD_BOOL,FMOD_DSP_FFT_WINDOW},
        morekeywords=[2]{return,if,else,switch,for,while,do,const,static,sizeof}, keywordstyle=[2]\bfseries\color{Magenta},
        morekeywords=[3]{printf,scanf,fprintf,fscanf,fputc,fgetc,fputs,fgets,fopen,fclose,fseek,ftell,rewind,srand,rand,
        time,SDL_Delay,SDL_GetTicks,SDL_AddTimer,SDL_RemoveTimer,TTF_OpenFont,TTF_CloseFont,TTF_Init,TTF_GetError,TTF_Quit,
        malloc,free,SDL_CreateRGBSurface,SDL_FreeSurface,SDL_BlitSurface,SDL_LoadBMP,SDL_WM_SetIcon,IMG_Load,SDL_GetError,
        SDL_Init,SDL_Quit,SDL_SetVideoMode,SDL_WM_SetCaption,SDL_FillRect,SDL_Flip,SDL_MapRGB,SDL_SetAlpha,SDL_SetColorKey,
    	SDL_PollEvent,SDL_WaitEvent,SDL_EnableKeyRepeat,SDL_ShowCursor,SDL_WarpMouse,TTF_RenderText_Blended,
    	TTF_SetFontStyle,sprintf,TTF_RenderText_Shaded,FMOD_System_Create,FMOD_System_Init,FMOD_System_Close,
    	FMOD_System_Release,FMOD_System_CreateSound,FMOD_System_PlaySound,FMOD_Sound_Release,FMOD_System_GetChannel,
    	FMOD_System_GetMasterChannelGroup,FMOD_Sound_SetLoopCount,FMOD_Channel_GetPaused,FMOD_Channel_SetPaused,
    	FMOD_Sound_Release,FMOD_ChannelGroup_GetPaused,FMOD_ChannelGroup_SetPaused,FMOD_Channel_GetSpectrum,
    	SDL_LockSurface,SDL_UnlockSurface},
        keywordstyle=[3]\color{RoyalBlue},
}
\lstnewenvironment{Csource}{\lstset{style=C}\setLTR}{\unsetLTR}
% Console
\lstnewenvironment{Console}{\setLTR}{\unsetLTR}
% Table settings
\setlength{\tabulinesep}{2pt}
\setlength{\arrayrulewidth}{2pt}
\taburulecolor{White}
\newenvironment{Table}[1]{ % Accepts 1 parameter which is the number of columns
\taburowcolors[2] 2{LightGray!40 .. LightGray!80}
\begin{center}
  \begin{tabu}{*{#1}{|r}|}
    \toprule
    \rowfont{\bfseries\color{White}}
    \rowcolor{OrangeRed}
    \everyrow{\hline}
}{
  \end{tabu}
\end{center}
}
\newenvironment{Table*}[1]{
\taburowcolors[1] 2{LightGray!40 .. LightGray!80}
\begin{center}
  \begin{tabu}{*{#1}{|r}|}
    \toprule
    \everyrow{\hline}
}{
  \end{tabu}
\end{center}
}

\title{تعلّم البرمجة بلغة الـC}
\begin{document}
  \include{Introduction}
  \include{Introduction_original}
  \part{أساسيّات البرمجة بلغة الـ\textenglish{C}}
  \include{Chapter_I-1}
  \include{Chapter_I-2}
  \include{Chapter_I-3}
  \include{Chapter_I-4}
  \include{Chapter_I-5}
  \include{Chapter_I-6}
  \include{Chapter_I-7}
  \include{Chapter_I-8}
  \include{Chapter_I-9}
  \part{تقنيات متقدّمة في لغة الـ\textenglish{C}}
  \include{Chapter_II-1}
  \include{Chapter_II-2}
  \include{Chapter_II-3}
  \include{Chapter_II-4}
  \include{Chapter_II-5}
  \include{Chapter_II-6}
  \include{Chapter_II-7}
  \include{Chapter_II-8}
  \include{Chapter_II-9}
  \include{Chapter_II-10}
  \part{إنشاء ألعاب \textenglish{2D} في \textenglish{SDL}}
  \include{Chapter_III-1}
  \include{Chapter_III-2}
  \include{Chapter_III-3}
  \include{Chapter_III-4}
  \include{Chapter_III-5}
  \include{Chapter_III-6}
  \include{Chapter_III-7}
  \include{Chapter_III-8}
  \include{Chapter_III-9}
  \part{هياكل البيانات}
  \include{Chapter_IV-1}
  \include{Chapter_IV-2}
\end{document}
