\chapter{عمل تطبيقي : "أكثر أو أقل"، لعبتك الأولى}

نصل اليوم إلى أول عمل تطبيقي. الهدف هو أن أريك أنك قادر على برمجة الكثير من الأشياء بما علّمتك إياه. لأنه في الواقع، الجانب النظري للغة أمر جيّد لكننا إن كنا لا نعرف كيف نطبّق ما تعلّمناه بشكل سلس فلا داعي لإهدار وقتنا بتعلم المزيد.

صدّق أو لا تصدّق، يسمح لك مستواك الآن ببرمجة أول برنامج ممتع. إنّه لعبة كونسول (أذكّرك بأننا سنصل للبرامج بنافذة لاحقا). مبدأ عمل اللعبة سهل للغاية، وسهل البرمجة، و لهذا اخترتها لتكون موضوع أول عمل تطبيقي لك.

\section{تجهيزات و نصائح}

\subsection{مبدأ عمل البرنامج}

قبل كلّ شيء، سأشرح عمل برنامجنا. إنّه لعبة صغيرة نسمّيها "أكثر أو أقل".

مبدأ عمل اللعبة  هو التالي.

\begin{enumerate}
	\item الجهاز يختار عشوائيا عددا من 1 إلى 100.
	\item يطلب منك أن تخمن عددا و بالتالي ستختار بدورك عددا من 1 إلى 100.
	\item يقوم الجهاز بمقارنة العدد الذي كتبته بالعدد "الغامض" الّذي حصل عليه عشوائيّا، ثم يقول لك ما إن كان العدد الغامض أصغر أو أكبر من العدد الذي اخترته أنت.
	\item ثم يقوم الجهاز بإعادة طلب العدد منك.
	\item ثم يقول لك ما إن كان العدد الغامض أصغر أو أكبر من العدد الذي اخترته أنت.
	\item و هكذا تستمر العملية حتى تجد أنت ذلك العدد.
\end{enumerate}
و الهدف من اللعبة هو أن تجد العدد الغامض في أقل عدد ممكن من المحاولات بالطبع.

و هذه "لقطة شاشة" مما يجب أن تكون عليه اللعبة في طور التنفيذ :

\begin{Console}
What's the number ? 50
Greater !
What's the number ? 75
Greater  !
What's the number ? 85
Lesser !
What's the number ? 80
Lesser !
What's the number ? 78
Greater !
What's the number ? 79
Bravo, you have found the mysterious number !!!
\end{Console}

\subsection{اختيار عدد عشوائي}

\begin{question}
لكن كيف يختار الجهاز عددا عشوائياً ؟ أنا لا أجيد فعل هذا !
\end{question}

صحيح، نحن لا نجيد كيفية توليد عدد عشوائي. و يجب القول أن طلب ذلك من الحاسوب ليس أمراً سهلاً~: هو يجيد القيام بعمليات حسابية، لكن أن يستخرج عدداً عشوائيا، هذا أمر لا يجيد فعله !

في الواقع، لـ"محاولة" الحصول على عدد عشوائيّ، يجب القيام بحسابات معقّدة للحاسوب، و هذا ما يعود في النهاية إلى القيام بحسابات !

لكي نفعل هذا، نميز حلين.
\begin{itemize}
	\item إما أن نطلب من المستعمل أن يقوم باختيار عددٍ عشوائي في بداية اللعبة بواسطة الدالة 
	\InlineCode{scanf}.
	هذا يستلزم لاعبين : واحد يقوم بإدخال العدد الغامض و الآخر يحاول تخمينه بعد ذلك.
	\item نجرّب طريقة ثانية لجعل الجهاز يختار وحده العدد. الشيء الجيّد هنا هي أنّك ستتمكن من لعب اللعبة لوحدك. أمّا الشيء السيّء هو \dots أنّني مضطرّ لأن أشرح لك كيف تقوم بذلك !
\end{itemize}

طبعا سنقوم بالاختيار الثاني و لكن إن أردت تجريب الحل الأول فيما بعد فلا شيء يمنعك.

لاختيار عدد عشوائي نستعمل الدالة 
\InlineCode{rand}.
و هي دالة تسمح باختيار عدد بطريقة عشوائية. لكنّنا نريد عدداً بين 1 و 100 مثلا (لأننا إن لم نعرف الحدود فستصبح اللعبة معقّدة جدّا).

للقيام بذلك، سنستخدم العبارة التالية (لا يمكنني أن أطلب منك تخمينها هي أيضاً !) :

\begin{Csource}
srand(time(NULL));
mysteriousNumber = (rand() % (MAX - MIN + 1)) + MIN;
\end{Csource}

السطر الأول (الذي بـه
\InlineCode{srand})
يسمح بتهيئة مولَد الأرقام العشوائية. نعم الأمر صعب قليلاً كما أخبرتك.
\InlineCode{mysteriousNumber}
هو متغير سيحمل العدد العشوائي المختار.

\begin{warning}
التعليمة 
\InlineCode{srand}
لا يجب أن تشغّل إلا مرة واحدة (في بداية البرنامج). فيجب وضع 
\InlineCode{srand}
مرة واحدة في البداية، و مرة واحدة فقط. \\
بعدها يمكنك استعمال القدر الذي تريده من الدالة 
\InlineCode{rand}
لاختيار العدد العشوائي. و لكن 
\underline{يجب ألّا}
 يقرأ جهازك التعليمة
\InlineCode{srand}
مرتين، لا تنس ذلك.
\end{warning}

\InlineCode{MAX}
و 
\InlineCode{MIN}
هما ثابتان، الأول هو العدد الأقصى (100) و الثاني هو العدد الأدنى (1)، و أنصحك بتعريف الثابتين في بداية البرنامج هكذا :

\begin{Csource}
const int MAX = 100, MIN = 1;
\end{Csource}

\subsection{تضمين المكتبات اللازمة}

كي يشتغل برنامجك بشكل صحيح، يجب أن تقوم بتضمين المكتبات 
\InlineCode{stdlib}
و 
\InlineCode{stdio}
و 
\InlineCode{time}
(الأخيرة تستعمل من أجل الأعداد العشوائية).\\
يجب إذن أن يبدأ برنامجك بالتالي :

\begin{Csource}
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
\end{Csource}

\subsection{يكفي شرحا !}

حسنا، سأتوقف هنا لأنه لو أكملت سأعطيك الشفرة الخاصة ببرمجة اللعبة كاملة !

\begin{information}
لتوليد الأعداد العشوائية، اضطررت لإعطائك شفرة "جاهزة" دون أن أشرح كيف تعمل بالضبط. عادة، لا أحبّ فعل هذا، لكن لا يوجد خيار هنا لأنني لا أريد تعقيد الأشياء كثيرا حاليّا.\\
تأكّد أنه ستتعلم فيما يلي الكثير من المفاهيم التي ستسمح لك بفهم هذه الأشياء بنفسك.
\end{information}

باختصار، أنت تعرف الكثير. لقد شرحت لك المبدأ و أعطيتك صورة عن البرنامج لحظة التشغيل.\\
بعد كل هذا أنت قادر على كتابة البرنامج لوحدك.

حان وقت العمل ! بالتوفيق !

\section{التصحيح !}
توقف ! من الآن سأجمع الأوراق.

سأعطيك طريقتي الخاصة لحلّ التطبيق. بالطبع هناك طرائق جيّدة عديدة لفعل ذلك. إن كانت لديك شفرة مصدريّة تختلف عن شفرتي و كانت تشتغل، فمن المحتمل أن تكون جيّدة أيضاً.

\subsection{تصحيح "أكثر أو أقل"}

 هذا هو التصحيح الذي أقترحه :
 
\begin{Csource}
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
int main ( int argc, char** argv )
{
	int mysteriousNumber = 0, inputNumber = 0;
	const int MAX = 100, MIN = 1;
	// Generation of random number
	srand(time(NULL));
	mysteriousNumber = (rand() % (MAX - MIN + 1)) + MIN;
	
	do
	{
		// We request the number
		
		printf("What's the number? ");
		scanf("%d", &inputNumber );
		// We compare between inputNumber and mysteriousNumber
		
		if (mysteriousNumber > inputNumber )
		printf("Greater !\n\n");
		else if (mysteriousNumber < inputNumber )
		printf("Lesser !\n\n");
		else
		printf ("Bravo, you have found the mysterious number !!!\n\n");
	} while (inputNumber != mysteriousNumber);
	return 0;
}
\end{Csource}

\subsection{الملف التنفيذي و الشفرة المصدرية}

 لمن يريد ذلك، اللعبة و الشفرة المصدرية متوفّران للتنزيل من هنا :

\textenglish{\url{https://openclassrooms.com/uploads/fr/ftp/mateo21/plusoumoins.zip} \mbox{(7 Ko)}}

\begin{information}
الملف التنفيذي 
(\InlineCode{.exe})
مترجم للويندوز، لذا إن كنت تستخدم نظام تشغيل آخر فيجب عليك إعادة ترجمة البرنامج ليشتغل عندك.
\end{information}

يوجد مجلّدان، واحد فيه الملف التنفيذي (مترجم للويندوز، أكرّر) و آخر فيه ملفات الشفرة المصدرية.

في حالة "أكثر أو أقل"، المصادر بسيطة جدّا : يوجد فقط الملف
\InlineCode{main.c}.\\
لا تفتح هذا الملفّ مباشرة، افتح أوّلا البيئة التطويرية الّتي تفضّلها، ثم انشئ مشروعا جديداً من نوع 
\textenglish{Console}
و قم باستيراد الملف 
\InlineCode{main.c}.
يمكنك ترجمة البرنامج من جديد للتجريب كما يمكنك التعديل عليه إن أردت.

\subsection{الشرح}

سأشرح الآن الشفرة المصدريّة الخاصة بي بدءً من الأعلى :

\subsubsection{توجيهات المعالج القبلي}

هي الأسطر التي تبدأ بعلامة 
\InlineCode{\#}
في الأعلى. و هي تقوم بتضمين المكتبات التي نحتاج إليها.\\
أعطيتها لك جاهزة أعلاه، لذلك فإن استطعت ارتكاب خطأ هنا، فأنت قويّ جدّا !

\subsubsection{المتغيرات}

لم نحتج الكثير منها.\\
احتجنا فقط واحدا للعدد الذي يدخله المستعمل
(\InlineCode{inputNumber}) 
و ثانٍ لكي نسمح للجهاز بتوليد عدد عشوائي 
(\InlineCode{mysteriousNumber}).

قمت بتعريف الثوابت كما ذكرت في بداية هذا الفصل. الشيء الجيد أيضاً هو إمكانية تحديد صعوبة اللعبة (بوضع أعلى قيمة هي 1000 مثلا)، يكفي أن نعدّل على هذا السطر و نعيد ترجمة البرنامج.

\subsubsection{الحلقة}

لقد اخترت الحلقة 
\InlineCode{do \dots while}.
نظريّا، حلقة 
\InlineCode{while}
بسيطة يمكنها أن تقوم بالمهمة أيضا، لكنّي وجدت بأن استخدام 
\InlineCode{do \dots while}
منطقيّ أكثر. 

لماذا ؟  لأنه إن كنت تتذكر، 
\InlineCode{do \dots while}
هي حلقة تسمح لنا بتشغيل التعليمات بين الحاضنتين على الأقل مرّة واحدة. و نحن سنطلب من المستعمل إدخال العدد الغامض لمرة واحدة على الأقل أيضاً (فالمستعمل غير قادر على تخمين العدد في أقل من محاولة واحدة، إلا إن كان شخصاً خارقاً !).

في كلّ دورة من الحلقة نطلب من المستعمل إدخال عدد. نقوم بتخزين القيمة في المتغير 
\InlineCode{inputNumber}.\\
بعدها، نقارن المتغير السابق بالمتغير 
\InlineCode{mysteriousNumber}.
هنا نجد ثلاثة احتمالات :

\begin{itemize}
	\item يكون الرقم الغامض أكبر من الرقم الذي أدخله المستعمل و بالتالي تظهر على الشاشة العبارة
	"\textenglish{Greater !}".
	\item يكون الرقم الغامض أصغر من الرقم الذي أدخله المستعمل و بالتالي تظهر على الشاشة العبارة
	"\textenglish{Lesser !}".
	\item يكون الرقم الغامض لا أكبر و لا أصغر من الّذي أدخله المستعمل، أي أنّه مساوٍ بالضرورة ! و بالتالي تظهر على الشاشة العبارة
	"\textenglish{Bravo, you have found it !}".
\end{itemize}

يجب أن تضع شرطا للحلقة. و هذا سهل للإيجاد : نعيد تشغيل الحلقة 
\textbf{مادام الرقم الذي تم ادخاله لا يساوي الرقم الغامض}.\\
و ما إن يتم إدخال العدد المطلوب تتوقف الحلقة و بالتالي ينتهى البرنامج هنا.
