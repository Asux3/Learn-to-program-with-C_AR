\chapter{تثبيت الـ\textenglish{SDL}}

ابتداءاً من الآن، إنتهت الدروس النظرية ! لأننا سنمرّ إلى مرحلة مهمّة، و سنستمتع بالتطبيق بالإستعانة بمكتبة نسميها
\underline{\textenglish{SDL}}.

في الدروس السابقة كنا قد تطرّقنا تقريباً لكلّ أساسيات اللغة
\textenglish{C}،
لكن تبقى هناك دائماً بعض التفاصيل الصعبة نوعاً ما لنكتشفها. سأقول لك بأنه يُمكن لهذا الكتاب أن يتوقّف هنا مخبرا إيّاك : "نعم لقد تعلّمت البرمجة بلغة 
\textenglish{C}"،
لكني متأكّد بأن الجميع سيشاركني الرأي لو قلت بأن المُبرمج سيحسّ نفسه دائماً مبتدئاً مادام لم "يخرج" من الكونسول !

الـ\textenglish{SDL}
هي مكتبة تُستخدم خاصّة لإنشاء ألعاب ثنائية الأبعاد. سنتعرّف في هذا الدرس على هذه المكتبة و نتعلّم كيف نقوم بتثبيتها.

نسمي هذا النوع من المكتبات بمكتبات الطرف الثالث 
(\textenglish{third party libraries}).
يجب أن تعرف أنه هناك نوعين من المكتبات :

\begin{itemize}
	\item \textbf{المكتبة القياسية}
	(\textenglish{standard library}) :
	و هي المكتبة القاعدية التي تعمل على كلّ أنظمة التشغيل (من هنا تم استنباط الكلمة 
	\textenglish{standard})
	و هي تسمح بالقيام بأمور بسيطة كـ\InlineCode{printf}.
	هذه المكتبات يتمّ تسطيبها تلقائيّا عند تثبيتك للبيئة التطويرية و المترجم.
	
	خلال الجزئين الأوّلين من هذا الكتاب، كناّ قد استعملنا المكتبة القياسيّة فقط
(\InlineCode{stdlib.h}، \InlineCode{stdio.h}، \InlineCode{string.h}، \InlineCode{time.h} \dots).
	لم نقم بدراستها بالتفصيل لكنّا جرّبنا منها جزءاً كبيراً. إن كنت تريد معرفة المزيد عن هذا النوع من المكتبات أجْرِ بحثاً في 
	\textenglish{Google}،
	مثلاً بكتابة
	"\textenglish{C standard library}"،
	و ستجد نماذج الدوال في هذه المكتبة، بالإضافة إلى شرح قصير حول دور كلّ دالة.
	\item \textbf{مكتبات الطرف الثالث}
	(\textenglish{third party libraries}):
	هي مكتبات لا يتم تثبيتها تلقائيا. و إنّما يجب عليك تنزيلها من الأنترنت و تثبيتها بنفسك على حاسوبك.

	على عكس المكتبات القياسية، التي تكون بسيطة نسبيّا و تحتوي على عدد قليل من الدوال، فإنه توجد الآلاف من مكتبات الطرف الثالث، و التي تمت كتابتها من طرف مبرمجين آخرين. بعضها جيّدة، و أخرى أقل، بعضها مدفوع، و بعضها الآخر مجاني، إلخ. الأمر المثالي هو إيجاد مكتبة جيّدة و مجانية في نفس الوقت !
\end{itemize}

إنه لمن المستحيل أن أضع لك درساً يشرح كل المكتبات الموجودة. حتّى لو أمضيت حياتي كلّها 24 ساعة / 24، لن أستطيع !\\
لذا سأقدّم لك مكتبة واحدة فقط مكتوبة بالـ\textenglish{C} و مُستعملة من طرف مبرمجين مثلك. 

هذه المكتبة تدعى 
\textit{\textenglish{SDL}}.
السؤال المطروح هو لماذا اخترت هذه المكتبة بالضبط ؟ ما الذي يميّزها عن باقي المكتبات ؟\\
هذه أسئلة سأبدأ في الإجابة عليها إنطلاقاً من الآن.

\section{لماذا نختار الـ\textenglish{SDL} ؟}

\subsection{اختيار مكتبة ليس بالأمر السهل !}

كما قلت لك الآن، توجد الآلاف من المكتبات للتنزيل.\\
بعضها بسيط، و بعضها كبير جداً لدرجة أن درساً كهذا لا يكفي أن يشرحها كلّها !

الاختيار صعب. لكنّي اخترت هذه المكتبة، التي هي نوعاً ما سهلة الاستعمال، كبداية. ستكون هذه إذا أوّل مكتبة تقوم باستعمالها (إذا لم نحسب المكتبة القياسية).

إنه من الواضح أن أغلب القرّاء يريدون معرفة كيفية فتح نوافذ، إنشاء لعبة، إلخ. و لكن إن كنت تحب الكونسول فيمكننا الاستمرار فيها لوقت أطول، إذا أردت، لا ؟ إذا لدينا هنا بعض الفضول ! \\
أودّ كثيراً أن أريك كيف تعمل كلّ هذه الأمور، لكننا سنحاول أن نتطرّق إليها خطوة بخطوة، و بالنسبة للأعمال التطبيقية، فلدينا عملان تطبيقيان لهذا الجزء من الكتاب !

لقد اخترت لك مكتبة سهلة و قوية، ستكون كبداية لك في تحقيق (تقريبا) أحلامك المتعلّقة بالواجهة الرسومية، و من دون تعب (حسناً، كلّ شيء نسبيّ بالطبع !).
\subsection{الـ\textenglish{SDL}، اختيار جيّد !}

سنقوم الآن بدراسة هذه المكتبة. لماذا اخترتها هي و ليس أخرى ؟

\Picture{Chapter_III-1_SDL}

\begin{itemize}
	\item \textbf{هي مكتبة مكتوبة بلغة
	\textenglish{C}} :
	 أي أنه بإمكان المبرمجين أن يستعملوها في برامجهم المكتوبة بالـ\textenglish{C}.
	 و كما هو الحال بالنسبة لأغلب المكتبات المكتوبة بالـ\textenglish{C}،
	 يمكن استعمالها في لغة الـ\textenglish{C++}
	 بالإضافة إلى لغات برمجية أخرى.
	 \item \textbf{هي مكتبة حُرّة و مجانية} :
و هذا كي لا تضطرّ لدفع أي ثمن مقابل استعمالك ما سأقدّمه لك في بقيّة الكتاب. على عكس ما قد نعتقد، إيجاد مكتبة جيدة و مجانية ليس أمراً صعباً كثيراً، فقد انتشرت كثيراً في أيامنا هذه. المكتبة الحرة هي ببساطة مكتبة يمكنك الحصول على الشفرة المصدرية الخاصة بها. في حالتنا هذه، رؤية الشفرة ليس مُهمّا بالنسبة لنا. لكن كونها حرة يفتح لنا الباب من أجل ميزات أخرى أهمّها المداومة (أي أنه إن توقف صاحب المكتبة عن تطويرها، يُمكن لمبرمجين آخرين أن يكملوا عمله)، بالإضافة إلى مجّانيّتها غالبا. هذا يعني عدم إمكانيّة اختفاء المكتبة في يوم من الأيام.
	 \item \textbf{يُمكنك إنشاء برامج تجارية ذات ملكية خاصة بفضل هذه المكتبة}.
	 قد أكون قد تسرّعت بهذا الكلام، لكنّه يجب اختيار مكتبة حرّة تمنحك الحريّة الأقصى. الحقيقة أنه يوجد نوعان من المكتبات الحُرة :
	 
	 \begin{itemize}
	 	\item المكتبات تحت 
	 	\textbf{رخصة \textenglish{GPL}} :
	 	 مكتبات مجانية، و يمكنك رؤية الشفرة المصدرية الخاصة بها، لكن بشرط أن تقوم أنت كذلك بنشر الشفرة المصدرية الخاصة بالبرنامج الذي أنشأته باستخدامها.
	 	\item المكتبات تحت 
	 	\textbf{رخصة \textenglish{LGPL}} :
	 	مثل سابقتها، لكن ليس عليك أن تنشر الشفرة المصدرية الخاصة بالبرنامج. أي أنه يمكنك بها إنشاء برامج مملوكة.
	 \end{itemize}
 	
 	\begin{information}
بالرغم من أنه يمكنك قانونيّا عدم نشر الشفرة المصدرية الخاصة بالبرنامج، إلا أنني أنصحك بذلك. فبهذا يمكنك أن تأخذ رأي المبرمجين الأكثر تمرّساً منك. و هذا يسمح لك بالتحسّن. بعد هذا، فإن إنشاء برنامج حُر أو ذو ملكية خاصة، يرجع لطبيعة تفكير كل شخص. لن أدخل في نقاش بخصوص هذا الموضوع، لكن فلتعلم أن كلّ النوعين له مميزاته و مساوئه.
 	\end{information}

 	\item هي مكتبة
 	\textbf{متعددة المنصّات} 
 	(\textenglish{multi-platform}) :
 	سواء كنت على الويندوز، الماك أو اللينكس، ستعمل لديك هذه المكتبة. و الحقيقة أن هذه نقطة قوّة يراها المبرمجون بالمكتبة : يمكنها أن تعمل على عدد كبير جداً من أنظمة التشغيل، فعلى غرار الويندوز و الينكس و الماك، هي تشتغل أيضاً على 
 	\textenglish{Atari}، \textenglish{Amiga}، \textenglish{Symbian}، \textenglish{Dreamcast} \dots
 	إلخ. أي أنه بالإمكان لبرامجك أن تعمل حتى على أجهزة 
 	\textenglish{Atari}
 	القديمة ! مع ذلك يجب القيام ببعض التعديلات و ربّما استخدام مترجم خاص. لن أدخل في التفاصيل هنا.
 	\item أخيرا، فإن هذه المكتبة تسمح لك بالقيام بالكثير من 
 	\textbf{الأمور الممتعة}
 	التي سنتعرّف إليها من خلال الدروس القادمة. لا أقول أنّ مكتبة رياضيّاتيّة قادرة على حلّ معادلات من الدرجة الرابعة ليست ممتعة، لكنّي سأركّز على أن يكون هذا الدرس سهلا قدر الإمكان لكيّ يحثّك على البرمجة.
\end{itemize}

هذه المكتبة ليست مخصصة فقط لإنشاء ألعاب الفيديو. سأعترف بأن معظم البرامج التي تمت كتابتها بهذه المكتبة، هي عبارة عن ألعاب، لكن هذا لا يعني أنك مجبر لاستعمالها من أجل ذلك . فكما نعلم، كلّ شيء ممكن بالعمل و الاجتهاد. كنت قد رأيت من قبل محرر نصوص تمت برمجته بالـ\textenglish{SDL}،
غلى الرغم من أنّه هناك مكتبات أخرى أحسن لهذا الغرض. إن كنت تريد برمجة واجهة رسومية تقليديّة تسمح بإظهار نافذة، زر، قائمة، إلخ. فأنا أنصحك إذا بالتوجّه إلى المكتبة 
\textenglish{GTK+}.

\subsection{الإمكانية المتاحة بالـ\textenglish{SDL}}

المكتبة
\textenglish{SDL}
هي مكتبة منخفضة المستوى. هل تتذكر أول الدروس حينما تكلّمت لك عن لغات البرمجة عالية المستوى و لغات البرمجة منخفضة المستوى ؟ هذا ينطبق على المكتبات أيضاً.

\begin{itemize}
	\item \textbf{المكتبات منخفضة المستوى} : 
	تحتوي على دوال قاعدية جدّا. يوجد عدد قليل من هذه الدوال لأنّه يمكننا القيام بكلّ شيء بها. و هذه الدوال لبساطتها تكون سريعة جدّا. لهذا فالبرامج المنشأة بهذا النوع من المكتبات تكون عادة الأسرع.
	\item \textbf{المكتبات عالية المستوى} : 
	تحتوي على الكثير من الدوال التي تسمح بالقيام بالكثير من المهام. هذا يجعلها أبسط من ناحية الاستخدام.
	
	لكن هذا النوع من المكتبات يكون عادة "كبيرا"، و ليس من السهل دراستها و معرفتها بأكملها. كما أنها قد تكون أثقل من المكتبات منخفضة المستوى (لكنّ هذا قد لا يكون واضحا).
\end{itemize}

على العموم، لا يمكننا القول بأن "مكتبة منخفضة المستوى هي أحسن من مكتبة عالية المستوى" أو العكس. فكلّ منهما لها مميزات و مساوئ. الـ\textenglish{SDL}
التي سنقوم بدراستها، تنتمي إلى المكتبات منخفضة المستوى.

يجب إذا أن تتذكر بأن الـ\textenglish{SDL}
تقدّم دوالا قاعدية. يمكنك إذا الرسم بيكسلا ببيكسل، رسم مستطيل أو إظهار صور. هذا كلّ شيء، و صدّقني أنّ هذا كافٍ.

\begin{itemize}
	\item بتحريك صورة، يمكنك أن تقوم بتحريك شخصيّة.
	\item بإظهار العديد من الصور الواحدة تلو الأخرى بسرعة، يمكنك إنشاء تحريك
	(\textenglish{animation}).
	\item بوضع العديد من الصور، الواحدة بجنب الأخرى، يكون باستطاعتك إنشاء لعبة حقيقيّة.
\end{itemize}

كمثال عن لعبة تم صنعها بالـ\textenglish{SDL}،
اعلم أنّ اللعبة الشهيرة
"\textenglish{Civilisation : Call to power}"،
تم دعمها في نظام اللينكس لاحقاً باستخدام الـ\textenglish{SDL}.

\Picture{Chapter_III-1_Game}

يجب أن تعلم أنّ جودة اللعبة تعود إليك و إلى الفريق الذي تعمل معه. إن كان لديك مصمم موهوب، فيمكنك صنع لعبة أجمل.

الشيء الوحيد الذي يحدّ الـ\textenglish{SDL}
هو أنها تقتصر على الألعاب ثنائية الأبعاد، و لم تُنشأ من أجل الألعاب ثلاثية الأبعاد. هذه أمثلة على ألعاب يمكن تحقيقها بالـ\textenglish{SDL}
(ليست سوى قائمة صغيرة، كلّ شيء ممكن مادام ثنائيّ الأبعاد) :

\begin{itemize}
	\item \textenglish{Breakout}
	\item \textenglish{Bomberman}
	\item \textenglish{Tetris}
	\item ألعاب المنصّات :
	\textenglish{Super Mario Bros}، \textenglish{Sonic}، \textenglish{Rayman}، \dots
	\item \textenglish{RPG} ثنائية الأبعاد :
	\textenglish{Zelda}،
	الأجزاء الأولى للعبة
	\textenglish{Final Fantasy}،
	إلخ.
\end{itemize}
لا يمكن وضع لائحة كاملة، الأمر يعود فقط للقدرة على التخيّل. و صدّقني بأنك قادر على برمجة ألعاب فائقة الروعة. فلقد رأيت أحد القرّاء ينشئ تهجينا بين
\textenglish{Breakout}
و
\textenglish{Tetris}.

فلنعد إلى الأرض و لنمسك خيط هذا الدرس. سنقوم الآن بتسطيب المكتبة، لنتمكّن من التقدّم في العمل.

\section{تنزيل الـ\textenglish{SDL}}

الموقع الرسمي للمكتبة 
\textenglish{SDL}
سيصبح قريبا الوجهة الّتي نقصدها كثيرا. هناك، يوجد كلّ ما تحتاجه، بدءً من المكتبة نفسها و مرورا إلى التوثيق 
(\textenglish{Documentation})
الخاص بها.

\url{http://www.libsdl.org/}

إذهب إلى اللائحة
\textenglish{Download}
المتواجدة على يسار الصفحة الرئيسية للموقع.\\
اختر النسخة الأحدث الّتي تجدها
(\textenglish{SDL 1.2}
عندما كتبت هذه السطور).

صفحة التنزيل مجزّأة إلى عدة أجزاء. 

\begin{itemize}
	\item \textbf{الشفرة المصدرية}
	(\textenglish{Source code}) :
هنا يمكنك تحميل الشفرة المصدرية الخاصة بالمكتبة. أدري أن القراء فضوليون ليعرفوا كيف تعمل المكتبة من الداخل، لكنّ هذا لن يفيدنا. الأسوأ هو أنّه سيقوم بإلهائك عن هدفنا الرئيسي.
	\item \textbf{مكتبات وقت التشغيل}
	(\textenglish{Runtime libraries}) :
	هي الملفات التي تحتاج إلى تقديمها مع الملف التنفيذي حين تريد أن تعطي برنامجك لشخص آخر. بالنسبة للويندوز، أنا أتكلم عن الملف 
	\InlineCode{SDL.dll}.
	هذا الأخير يجدر به أن يتواجد إما :
	
	\begin{itemize}
		\item بنفس المجلّد الذي يحتوي الملف التنفيذي
		(أنا أنصحك بهذا). الأحسن دائما هو أن تعطي الـ\textenglish{DLL}
		مع الملف التنفيذي و تبقيهم في نفس المجلد. إذا وضعت الـ\textenglish{DLL}
		في المجلّد الخاص بالويندوز، لن يكون عليك إلحاق الـ\textenglish{DLL}
		مع كلّ مجلّد يحتوي البرنامج
		\textenglish{SDL}.
		و مع ذلك قد تحدث بعض المشاكل في حال ما قمت بمسح نسخة أحدث من الـ\textenglish{DLL}.
		\item في المجلّد
		\InlineCode{C:\textbackslash Windows}.
	\end{itemize}
	
	\item \textbf{مكتبات التطوير}
	(\textenglish{Development libraries}) :
	هي الملفات
	\InlineCode{.a}
	(أو
	\InlineCode{.lib}
	بالنسبة للـ\textenglish{Visual})
	و الملفات 
	\InlineCode{.h}
	التي تسمح بإنشاء برامجك
	\textenglish{SDL}.
	هذه الملفات ليست مفيدة إلا بالنسبة إليك أنت فقط المبرمج. أي أنه ليس عليك تقديمها مع ملفات البرنامج حين تنتهي من هذا الأخير.
\end{itemize}

إذا كنت تعمل في الويندوز، فسأعطيك ثلاثة نسخ، و ذلك حسب المترجم الخاص بك :

\begin{itemize}
	\item \textenglish{VC6} :
	بالنسبة للذين يستخدمون النسخ القديمة غير المجانية من
	\textenglish{Visual studio}
	(لا أعتقد أن هناك من القرّاء من لازال يستعمل هذه النسخ). ستجد فيها على أي حال الملفات
	\InlineCode{.lib}.
	\item \textenglish{VC8} :
	 بالنسبة للذين يستعملون 
	\textenglish{Visual Studio 2005 Express}
	أو نسخة أحدث، ستجد فيها الملفات
	\InlineCode{.lib}.
	\item \textenglish{mingw32} :
	بالنسبة للذين يستعملون 
	\textenglish{Code::Blocks}
	(ستجدون فيها إذا الملفات
	\InlineCode{.a}).
\end{itemize}

الشيء الخاص هنا، هو أن "مكتبات التطوير" تحتوي كل الملفات
\InlineCode{.h}
و الملفات
\InlineCode{.a}
(أو
\InlineCode{.lib})
بالطبع، لكنها تحتوي أيضاً الملف 
\InlineCode{SDL.dll}
و ملفات التوثيق الخاصة بالـ\textenglish{SDL} !\\
باختصار، كلّ ما عليك تحميله هو "مكتبات التطوير"، فكلّ ما تحتاجه يتواجد بداخلها.

\begin{information}
لا تخطئ في الرابط ! قم باختيار الـ\textenglish{SDL}
في قسم
"\textenglish{Development libraries}"
و ليس من قسم
"\textenglish{Source code}" !
\end{information}

\begin{question}
ماذا هو التوثيق 
(\textenglish{Documentation}) ؟
\end{question}

التوثيق هو قائمة تحوي اللائحة الكاملة للدوال الخاصة بمكتبة معيّنة. و كل هذه الملفات تكون مكتوبة بالانجليزية (حتى لو كان كاتبوها مبرمجين فرنسيين). هذا سبب آخر يدفعك للتقدّم في لغة
\textenglish{Shakespeare} !

محتوى ملفات التوثيق  ليس عبارة عن درس، بل هي عادة موجزة. الشيء الإيجابي بالنسبة لدرس، هي أنّها تحتوي قائمة لكل الدوال الموجودة،  فهي إذا المرجع للمبرمج.\\
في كثير من الأحيان ستجد مكتبات بدون دروس تشرح كيفية عملها. و هنا لا يبقى لك سوى التوثيق الّذي نسميه عادة
"\textenglish{doc}"،
و يجب عليك تدبّر أمرك بهذا فقط (حتّى لو كان هذا صعبا أحيانا عندما تبدأ من دون أيّة مساعدة). المبرمج الحقيقيّ هو من يتمكّن من إيجاد ضالّته في الـ"\textenglish{doc}".

لحدّ الآن، أنت لست بحاجة إلى التوثيق الخاص بالـ\textenglish{SDL}
لأنني أنا من سيشرح لك كيفية عملها. لكن بما أنني غير قادر على أن أشرح لك كل الدوال التي بها، ستحتاج إلى قراءة التوثيق لاحقا. 

ملفّات التوثيق توجد أصلاً في الحزمة
"\textenglish{Development libraries}"
كما سبق و ذكرت، لكن بإمكانك تحميلها وحدها من القائمة
\InlineCode{Documentation} / \InlineCode{Downloadable}.\\
أنصحك أن تجمع ملفات
\textenglish{HTML}
الخاصة بالتوثيق في مجلّد خاصّ (اسمه مثلاً
\InlineCode{Doc SDL})
ثم انشاء اختصار إلى الفهرس
\InlineCode{index.html}.
و الهدف من هذا هو الوصول إلى هذه الملفات بشكل أسرع حينما تحتاج إليها.
